# Scalafmt configuration for DCCV project - Scala 3
version = "3.8.3"

# Basic configuration for readability and consistency
maxColumn = 100

indent {
  main = 2
  significant = 2
  callSite = 2
  ctrlSite = 2
  defnSite = 2
  caseSite = 2
  withSiteRelativeToExtends = 2
}

# Newlines configuration
newlines {
  source = "fold"
  beforeCurlyLambdaParams = "multilineWithCaseOnly"
  afterCurlyLambdaParams = "never"
  implicitParamListModifierPrefer = "before"
  sometimesBeforeColonInMethodReturnType = false
  beforeMultiline = "unfold"
  alwaysBeforeElseAfterCurlyIf = true
  afterInfix = "many"
  afterInfixBreakOnNested = true
  avoidForSimpleOverflow = ["slc"]
}

# Alignment configuration - DISABLED for arrows to prevent spacing issues
align {
  preset = "none"
  tokens = [
    {code = "=", owner = "(Enumerator.Val|Defn.(Va(l|r)|Def|Type))"},
    {code = "//", owner = ".*"}
  ]
  arrowEnumeratorGenerator = false
  openParenCallSite = false
  openParenDefnSite = false
  multiline = false
}

# Rewrite rules for better Scala 3 style
rewrite {
  rules = [
    "RedundantBraces",
    "RedundantParens",
    "SortImports",
    "PreferCurlyFors"
  ]
  
  redundantBraces {
    maxLines = 1
    includeUnitMethods = true
    stringInterpolation = true
    generalExpressions = true
  }
}

# Spaces configuration
spaces {
  beforeContextBoundColon = "Never"
  afterTripleEquals = true
  inImportCurlyBraces = true
  inInterpolatedStringCurlyBraces = false
  inParentheses = false
  neverAroundInfixTypes = []
  afterKeywordBeforeParen = true
  inByNameTypes = true
  afterSymbolicDefs = false
}

# Documentation strings
docstrings {
  style = "Asterisk"
  oneline = "fold"
  wrap = "yes"
  blankFirstLine = "yes"
}

# Project configuration
project {
  git = true
  excludeFilters = [
    "glob:**/target/**",
    "glob:**/.bloop/**",
    "glob:**/.metals/**"
  ]
}

# Runner configuration for Scala 3
runner {
  dialect = "scala3"
}

# Literals formatting
literals {
  long = "Upper"
  float = "Lower"
  double = "Lower"
  hexPrefix = "Lower"
  hexDigits = "Lower"
  scientific = "Lower"
}

# Trailing commas - always add them for better diffs
trailingCommas = "always"

# XML literals
xmlLiterals {
  assumeFormatted = true
}

# Binpack configuration - more conservative
binPack {
  literalArgumentLists = false
  literalsMinArgCount = 3
  parentConstructors = "Never"
}

# Vertical multiline configuration
verticalMultiline {
  atDefnSite = true
  arityThreshold = 3
  newlineAfterOpenParen = true
}

# Comments formatting
comments {
  wrap = "trailing"
  wrapStandaloneSlcAsSlc = true
}